<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: item-image.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: item-image.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Item Image
 * @module item image
 */
'use strict';

const Promise = require('bluebird');
const jsonPath = require('jsonpath');

const config = require('./config');
const getItems = require('./items').getItems;
const utils = require('./utils');
const requireParam = utils.requireParam;
const removeTrailingSlash = utils.removeTrailingSlash;

const dataDragonUrl = removeTrailingSlash(config.dataDragonUrl) || 'http://ddragon.leagueoflegends.com/cdn/6.24.1/img/item';

/**
 * Retrieves item image URL.
 * @function getItemImageUrl
 *
 * @param {string} itemName Name of an item in League of Legends
 * @param {string} riotApiKey Riot Games API key
 * @returns {Promise} Item image URL
 */
const getItemImageUrl = Promise.method((
    itemName = requireParam('itemName'),
    riotApiKey = (config.riotApiKey || requireParam('riotApiKey'))
) => {
    return getItems(riotApiKey)
        .then((items) => {
            if (items) {
                //Find the item we are looking for and parse its image name.
                //[0] because JSONPath returns array but since we know LoL items are uniquely named, there'll be only 1 result.
                //${itemName} below is staticly evaluated with no side effects.
                //See JSONPath reference: http://goessner.net/articles/JsonPath/index.html#e2
                let itemImageName = jsonPath.query(items, `$..[?(@.name=="${itemName}")].image.full`)[0];

                if (itemImageName &amp;&amp; itemImageName.length > 0) {
                    let itemImageUrl = `${dataDragonUrl}/${itemImageName}`;
                    return itemImageUrl;
                } else {
                    throw new Error(`Cannot get item image url for ${itemName}`)
                }
            } else {
                throw new Error('Invalid items object!');
            }
        })
        .catch((err) => {
            throw new Error(err);
        })
})

module.exports = getItemImageUrl;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-item%2520image.html">item image</a></li><li><a href="module-items.html">items</a></li><li><a href="module-utils.html">utils</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed May 03 2017 00:29:59 GMT+0200 (Central Europe Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
